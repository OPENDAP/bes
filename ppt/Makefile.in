prefix = @prefix@
exec_prefix = $(prefix)
libdir = $(exec_prefix)/lib
includedir = $(exec_prefix)/include/opendap-g
AR = ar
CXX = @CXX@
RANLIB = @RANLIB@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

SRCS:=PPTClient.cc Socket.cc TcpSocket.cc UnixSocket.cc SocketUtilities.cc \
	SocketListener.cc PPTServer.cc PPTProtocol.cc \
	PPTConnection.cc
OBJS:=PPTClient.o Socket.o TcpSocket.o UnixSocket.o SocketUtilities.o \
	SocketListener.o PPTServer.o PPTProtocol.o \
	PPTConnection.o
HDRS:=PPTClient.h Socket.h TcpSocket.h UnixSocket.h SocketUtilities.h \
	SocketException.h PPTException.h SocketConfig.h \
	SocketListener.h PPTServer.h PPTProtocol.h \
	PPTConnection.h Connection.h ServerHandler.h

INCS:=-I.
LIB:=libppt.a
DEFS:=@DEFS@
#CXXFLAGS_DEBUG:=-g3 -O0 -Wall -fno-default-inline -fno-defer-pop
#CXXFLAGS:=$(CXXFLAGS_DEBUG) 
CXXFLAGS:=@CXXFLAGS@ -Wall -Wno-deprecated
CPPFLAGS:=$(CXXFLAGS) $(DEFS) $(INCS)

all : $(LIB)

%.o : %.cc
	$(CXX) -c $(CPPFLAGS) $<

$(LIB) : $(OBJS)
	$(AR) cru $@ $?
	$(RANLIB) $@

install: all install-headers
	-mkdir -p $(libdir)
	$(INSTALL_DATA) $(LIB) $(libdir)
	$(RANLIB) $(libdir)/$(LIB)

install-headers:
	-mkdir -p $(includedir)
	for h in $(HDRS); \
	    do $(INSTALL_DATA) $$h $(includedir); done

Makefile: Makefile.in
	if [ -x ./config.status ]; \
	then \
	    ${SHELL} ./config.status; \
	else \
	    ./configure; \
	fi

.PHONY: depend
depend: 
	@depend@ -m Makefile.in -- $(CPPFLAGS) -- $(SRCS)
	$(MAKE) $(MFLAGS) Makefile

clean :
	/bin/rm -rf $(OBJS) $(LIB) $(MODOBJS) $(TESTEXEC) $(TESTOBJ)

distclean : clean
	-rm -f Makefile config.status config.log config.cache

# DO NOT DELETE; depend requires this line
PPTClient.o: PPTClient.cc PPTClient.h PPTConnection.h Connection.h \
  Socket.h TcpSocket.h UnixSocket.h PPTProtocol.h SocketException.h \
  PPTException.h
Socket.o: Socket.cc Socket.h SocketException.h
TcpSocket.o: TcpSocket.cc TcpSocket.h Socket.h SocketConfig.h \
  SocketException.h
UnixSocket.o: UnixSocket.cc UnixSocket.h Socket.h SocketException.h \
  SocketUtilities.h
SocketUtilities.o: SocketUtilities.cc SocketUtilities.h
SocketListener.o: SocketListener.cc SocketListener.h SocketException.h \
  Socket.h SocketConfig.h
PPTServer.o: PPTServer.cc PPTServer.h PPTConnection.h Connection.h \
  Socket.h PPTException.h PPTProtocol.h SocketListener.h ServerHandler.h
PPTProtocol.o: PPTProtocol.cc PPTProtocol.h
PPTConnection.o: PPTConnection.cc PPTConnection.h Connection.h Socket.h \
  PPTProtocol.h
