# Process with autom4te to create an -*- Autotest -*- test suite.


# ------------------------------
#

AT_INIT([curl getdap])
# AT_COPYRIGHT([])

AT_TESTED([curl])

# Usage: _AT_TEST_*(<curl source>, <baseline file>)

#This is for the CF option. The testing files are under h5.cf. It is using bes.conf
m4_define([_AT_MEMCACHE_TEST],   
[AT_SETUP([MemCacheMetadata $1])
AT_KEYWORDS([memcache])

# Use the following AT_CHECK to generate baseline file.
#AT_CHECK([curl -s localhost:8080/opendap/hyrax/data/hdf5/nasa-data/$1 > $2|| true], [], [stdout], [stderr])
AT_CHECK([curl -s localhost:8080/opendap/hyrax/data/hdf5/nasa-data/$1 || true], [], [stdout], [stderr])
AT_CHECK([diff -b -B $2 stdout || diff -b -B $2 stderr], [], [ignore],[],[])
AT_CLEANUP])

m4_define([AT_MEMCACHE_RESPONSE_TEST],
[_AT_MEMCACHE_TEST([$1], [$abs_srcdir/h5.nasa.mem/$1.curlout])
])

m4_define([_AT_MEMCACHE_BINARYDATA_TEST],   
[AT_SETUP([MemCacheData $1])
AT_KEYWORDS([memcache])

# Use the following AT_CHECK to generate baseline file.
#AT_CHECK([curl -s localhost:8080/opendap/hyrax/data/hdf5/nasa-data/$1 | getdap -M - > $2|| true], [], [stdout], [stderr])
AT_CHECK([curl -s -g localhost:8080/opendap/hyrax/data/hdf5/nasa-data/$1 |getdap -M -|| true], [], [stdout], [stderr])
AT_CHECK([diff -b -B $2 stdout || diff -b -B $2 stderr], [], [ignore],[],[])
AT_CLEANUP])

m4_define([AT_MEMCACHE_BINARYDATA_RESPONSE_TEST],
[_AT_MEMCACHE_BINARYDATA_TEST([$1], [$abs_srcdir/h5.nasa.mem/$1.curlout])
])

AT_MEMCACHE_RESPONSE_TEST([DeepBlue-SeaWiFS-1.0_L3_19970903_v003-20111127T185012Z.h5.das])
AT_MEMCACHE_RESPONSE_TEST([DeepBlue-SeaWiFS-1.0_L3_19970903_v003-20111127T185012Z.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([DeepBlue-SeaWiFS-1.0_L3_20100101_v002-20110527T191319Z.h5.das])
AT_MEMCACHE_RESPONSE_TEST([DeepBlue-SeaWiFS-1.0_L3_20100101_v002-20110527T191319Z.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([GSSTF.2b.2008.01.01.he5.das])
AT_MEMCACHE_RESPONSE_TEST([GSSTF.2b.2008.01.01.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L3ZAD_v06-00-00-c02_2005d022-2008d077.he5.das])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L3ZAD_v06-00-00-c02_2005d022-2008d077.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.das])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMNO2_2016m0215t0210-o61626_v003-2016m0215t200753.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMNO2_2016m0215t0210-o61626_v003-2016m0215t200753.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMUVB_2006m0104t0019-o07831_v003-2008m0716t0249.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMUVB_2006m0104t0019-o07831_v003-2008m0716t0249.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2G-OMTO3G_2004m1001_v003-2009m0602t123920.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2G-OMTO3G_2004m1001_v003-2009m0602t123920.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMAEROe_2012m0213_v003-2012m0215t021315.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMAEROe_2012m0213_v003-2012m0215t021315.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMAERUVd_2009m0109_v003-2011m1203t141123.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMAERUVd_2009m0109_v003-2011m1203t141123.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMSO2e_2012m0101_v003-2012m0103t014459.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L3-OMSO2e_2012m0101_v003-2012m0103t014459.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([Q20103372010343.L3m_7D_SCIB1_V1.0_SSS_1deg.h5.das])
AT_MEMCACHE_RESPONSE_TEST([Q20103372010343.L3m_7D_SCIB1_V1.0_SSS_1deg.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([Q2011149002900.L2_SCI_V1.0.bz2.0.bz2.0.h5.das])
AT_MEMCACHE_RESPONSE_TEST([Q2011149002900.L2_SCI_V1.0.bz2.0.bz2.0.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([Q20111722011263.L3b_SNSU_EVSCI_V1.2.main.h5.das])
AT_MEMCACHE_RESPONSE_TEST([Q20111722011263.L3b_SNSU_EVSCI_V1.2.main.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([TES-Aura_L2-O3-Nadir_r0000011015_F05_07.he5.das])
AT_MEMCACHE_RESPONSE_TEST([TES-Aura_L2-O3-Nadir_r0000011015_F05_07.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([TES-Aura_L3-CH4_r0000010410_F01_07.he5.das])
AT_MEMCACHE_RESPONSE_TEST([TES-Aura_L3-CH4_r0000010410_F01_07.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([acos_L2s_110419_43_Production_v110110_L2s2800_r01_PolB_110430192739.h5.das])
AT_MEMCACHE_RESPONSE_TEST([acos_L2s_110419_43_Production_v110110_L2s2800_r01_PolB_110430192739.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([mabel_l2a_20110322T165030_005_1.h5.das])
AT_MEMCACHE_RESPONSE_TEST([mabel_l2a_20110322T165030_005_1.h5.dds])

# Test for HFVHANDLER-72
AT_MEMCACHE_RESPONSE_TEST([BUV-Nimbus04_L3zm_v01-00-2012m0203t144121.h5.das])
AT_MEMCACHE_RESPONSE_TEST([BUV-Nimbus04_L3zm_v01-00-2012m0203t144121.h5.dds])

# Test for HFVHANDLER-77
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMBRO_2012m1204t1200-o44623_v003-2012m1204t185453.he5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI-Aura_L2-OMBRO_2012m1204t1200-o44623_v003-2012m1204t185453.he5.dds])

# Test for HFVHANDLER-75
AT_MEMCACHE_RESPONSE_TEST([GOZ-Source-MLP_HCl_ev1-00_2005.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([GOZ-Source-MLP_HCl_ev1-00_2005.nc4.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([OMI_L3.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([OMI_L3.nc4.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2006.06.15.239_airs.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2006.06.15.239_airs.nc4.h5.dds])

# Test for HFVHANDLER-82
AT_MEMCACHE_RESPONSE_TEST([GLAH13_633_2103_001_1317_0_01_0001.h5.das])
AT_MEMCACHE_RESPONSE_TEST([GLAH13_633_2103_001_1317_0_01_0001.h5.dds])

# HFVHANDLER-85
AT_MEMCACHE_RESPONSE_TEST([GSSTFYC.3.Year.1988_2008.he5.das])
AT_MEMCACHE_RESPONSE_TEST([GSSTFYC.3.Year.1988_2008.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L2_v06-00-00-c01_2008d001.he5.das])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L2_v06-00-00-c01_2008d001.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L3SCOL_v06-00-00-c02_2005d022-2008d077.he5.das])
AT_MEMCACHE_RESPONSE_TEST([HIRDLS-Aura_L3SCOL_v06-00-00-c02_2005d022-2008d077.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-BrO_v02-23-c01_2010d255.he5.das])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-BrO_v02-23-c01_2010d255.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-O3_v03-40-NRT-06-c01_2013d024t0010.he5.das])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-O3_v03-40-NRT-06-c01_2013d024t0010.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([SBUV2-NOAA17_L2-SBUV2N17L2_2011m1231_v01-01-2012m0905t152911.h5.das])
AT_MEMCACHE_RESPONSE_TEST([SBUV2-NOAA17_L2-SBUV2N17L2_2011m1231_v01-01-2012m0905t152911.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2011.03.11.001_amsu.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2011.03.11.001_amsu.nc4.h5.dds])

AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-O3_v03-40-NRT-06-c01_2013d024t0010.he5.das])
AT_MEMCACHE_RESPONSE_TEST([MLS-Aura_L2GP-O3_v03-40-NRT-06-c01_2013d024t0010.he5.dds])
AT_MEMCACHE_RESPONSE_TEST([SBUV2-NOAA17_L2-SBUV2N17L2_2011m1231_v01-01-2012m0905t152911.h5.das])
AT_MEMCACHE_RESPONSE_TEST([SBUV2-NOAA17_L2-SBUV2N17L2_2011m1231_v01-01-2012m0905t152911.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2011.03.11.001_amsu.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([matched-airs.aqua_cloudsat-v3.1-2011.03.11.001_amsu.nc4.h5.dds])

#HFVHANDLER-112
AT_MEMCACHE_RESPONSE_TEST([1A.GPM.GMI.COUNT2014v3.20140305-S061920-E075148.000087.V03A.h5.das])
AT_MEMCACHE_RESPONSE_TEST([1A.GPM.GMI.COUNT2014v3.20140305-S061920-E075148.000087.V03A.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.das])
AT_MEMCACHE_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([3A-MO.GPM.GMI.GRID2014R1.20140601-S000000-E235959.06.V03A.h5.das])
AT_MEMCACHE_RESPONSE_TEST([3A-MO.GPM.GMI.GRID2014R1.20140601-S000000-E235959.06.V03A.h5.dds])

#HFVHANDLER-129
AT_MEMCACHE_RESPONSE_TEST([A20030602003090.L3m_MO_AT108_CHL_chlor_a_4km.h5.das])
AT_MEMCACHE_RESPONSE_TEST([A20030602003090.L3m_MO_AT108_CHL_chlor_a_4km.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([LPRM-AMSR2_L2_D_SOILM2_V001_20120702231838.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([LPRM-AMSR2_L2_D_SOILM2_V001_20120702231838.nc4.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([LPRM-AMSR2_L3_A_SOILM3_V001_20121216010911.nc4.h5.das])
AT_MEMCACHE_RESPONSE_TEST([LPRM-AMSR2_L3_A_SOILM3_V001_20121216010911.nc4.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([S20030602003090.L3m_MO_ST92_CHL_chlor_a_9km.h5.das])
AT_MEMCACHE_RESPONSE_TEST([S20030602003090.L3m_MO_ST92_CHL_chlor_a_9km.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([good_imerge.h5.das])
AT_MEMCACHE_RESPONSE_TEST([good_imerge.h5.dds])
AT_MEMCACHE_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.das])
AT_MEMCACHE_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dds])

# This is like 1-group 2-D lat/lon netCDF-4-like HDF5 file
AT_MEMCACHE_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.das])
AT_MEMCACHE_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.dds])


#### Checking coordinate variables
#HDF-EOS5 swath 
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.dods?Temperature_Pressure[0:1:2]])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.dods?Temperature_Pressure@<:@0:1:2@:>@])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.dods?WMOTPPressure_MLS_Latitude[0:1000:3494]])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MLS-Aura_L2GP-Temperature_v03-33-c01_2011d316.he5.dods?WMOTPPressure_MLS_Latitude@<:@0:1000:3494@:>@])

#HDF-EOS5 grid
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([GSSTFYC.3.Year.1988_2008.he5.dods?lon[0:359:1439]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Latitude[0:79:179]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Pressure[0:1:8]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Prs2_1[0:3:8]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?NTWO[0:1:1]])

AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([GSSTFYC.3.Year.1988_2008.he5.dods?lon@<:@0:359:1439@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Latitude@<:@0:79:179@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Pressure@<:@0:1:8@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?Prs2_1@<:@0:3:8@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([MOP03T-20131129-L3V4.2.1.h5.dods?NTWO@<:@0:1:1@:>@])


#HDF5 general swath
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.dods?S1_Latitude@<:@[0:1000:2961][0:100:220]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.dods?nlyrs@<:@[0:8:27]])

AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.dods?S1_Latitude@<:@0:1000:2961@:>@@<:@0:100:220@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([2A.GPM.GMI.GPROF2014v1-4.20140921-S002001-E015234.003195.V03C.h5.dods?nlyrs@<:@0:8:27@:>@])


#HDF5 general grid
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([good_imerge.h5.dods?lat[0:899:1799]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([3A-MO.GPM.GMI.GRID2014R1.20140601-S000000-E235959.06.V03A.h5.dods?nlayer[0:5:27]])
#AT_MEMCACHE_RESPONSE_TEST([A20030602003090.L3m_MO_AT108_CHL_chlor_a_4km.h5.dods?columns[0:4319:8639]])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([good_imerge.h5.dods?lat@<:@0:899:1799@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([3A-MO.GPM.GMI.GRID2014R1.20140601-S000000-E235959.06.V03A.h5.dods?nlayer@<:@0:5:27@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([A20030602003090.L3m_MO_AT108_CHL_chlor_a_4km.h5.dods?columns@<:@0:4319:8639@:>@])


#netCDF-4-like swath
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([LPRM-AMSR2_L2_D_SOILM2_V001_20120702231838.nc4.h5.dods?Latitude[0:1000:2014][0:100:242]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.dods?GEOLOCATION_DATA_Latitude[0:100:391][0:10:34]])
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.dods?nLevels[0:1:4]])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([LPRM-AMSR2_L2_D_SOILM2_V001_20120702231838.nc4.h5.dods?Latitude@<:@0:1000:2014@:>@@<:@0:100:242@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.dods?GEOLOCATION_DATA_Latitude@<:@0:100:391@:>@@<:@0:10:34@:>@])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([TOMS-N7_L2-TOMSN7AERUV_1991m0630t0915-o64032_v02-00-2015m0918t123456.h5.dods?nLevels@<:@0:1:4@:>@])


#netCDF-4-like grid
#AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([OMI_L3.nc4.h5.dods?OMI_Column_Amount_O3_lon[0:719:1399]])
AT_MEMCACHE_BINARYDATA_RESPONSE_TEST([OMI_L3.nc4.h5.dods?OMI_Column_Amount_O3_lon@<:@0:719:1399@:>@])


