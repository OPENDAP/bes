prefix = @prefix@
exec_prefix = $(prefix)
bindir = $(exec_prefix)/bin
AR = ar
CXX = @CXX@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

MODULES = @MODULES@
PACKAGES = @PACKAGES@

SRCS:=OPeNDAPServerHandler.cc ServerApp.cc
OBJS:=OPeNDAPServerHandler.o ServerApp.o

PROGS:=opendapserver opendapdaemon
PROG_SRCS:=daemon.cc
PROG_OBJS:=daemon.o

INCS:=-I. -I../ppt -I../dispatch -I../command @INCS@

DEFS:=@DEFS@

LDFLAGS:=@LDFLAGS@
DEPLIBS:=../ppt/libppt.a ../command/libopendap_command.a ../dispatch/libdispatch.a
LIBS:=@LIBS@
MODS=../command/opendap_commands.o ../dispatch/dods_module.o ../dispatch/test_authenticator.o
SLDFLAGS:=$(OBJS) $(MODS) $(MODULES) $(PACKAGES) $(LDFLAGS) $(DEPLIBS) $(LIBS)

#CXXFLAGS_DEBUG:=-g3 -O0 -Wall -fno-default-inline -fno-defer-pop
#CXXFLAGS:=$(CXXFLAGS_DEBUG) 
CXXFLAGS:=@CXXFLAGS@ -Wall -Wno-deprecated
CPPFLAGS:=$(CXXFLAGS) $(DEFS) $(INCS)

all : $(PROGS)

opendapserver : $(OBJS) $(MODS) $(DEPLIBS)
	$(CXX) -o opendapserver $(SLDFLAGS)

opendapdaemon : daemon.o
	$(CXX) -o opendapdaemon daemon.o $(LDFLAGS)

%.o : %.cc
	$(CXX) -c $(CPPFLAGS) $<

install: install-progs

install-progs: $(PROGS)
	-mkdir -p $(bindir)
	$(INSTALL_PROGRAM) -s $(PROGS) $(bindir)

Makefile: Makefile.in
	if [ -x ./config.status ]; \
	then \
	    ${SHELL} ./config.status; \
	else \
	    ./configure; \
	fi

.PHONY: depend
depend: 
	@depend@ -m Makefile.in -- $(CPPFLAGS) -- $(SRCS) $(PROG_SRCS)
	$(MAKE) $(MFLAGS) Makefile

clean :
	-rm -f $(OBJS) $(PROG_OBJS) $(PROGS)

distclean : clean
	-rm -rf ServerConfig.h Makefile config.log config.status config.cache autom4te.cache

# DO NOT DELETE; depend requires this line
OPeNDAPServerHandler.o: OPeNDAPServerHandler.cc OPeNDAPServerHandler.h \
  ../ppt/ServerHandler.h ../ppt/Connection.h ../ppt/Socket.h \
  ../command/OPeNDAPCmdInterface.h ../dispatch/DODS.h \
  ../dispatch/DODSDataHandlerInterface.h ../dispatch/DODSContainer.h \
  ../dispatch/DODSDataRequestInterface.h ../dispatch/TheDODSKeys.h \
  ../dispatch/DODSKeys.h ../dispatch/DODSBasicException.h \
  ../dispatch/DODSException.h ServerExitConditions.h \
  ../dispatch/DODSStatusReturn.h
ServerApp.o: ServerApp.cc ServerApp.h ../dispatch/OPeNDAPBaseApp.h \
  ../dispatch/OPeNDAPApp.h ../dispatch/OPeNDAPObj.h \
  ServerExitConditions.h ../dispatch/TheDODSKeys.h ../dispatch/DODSKeys.h \
  ../ppt/SocketListener.h ../ppt/TcpSocket.h ../ppt/Socket.h \
  ../ppt/UnixSocket.h OPeNDAPServerHandler.h ../ppt/ServerHandler.h \
  ../ppt/PPTException.h ../ppt/PPTServer.h ../ppt/PPTConnection.h \
  ../ppt/Connection.h ../ppt/SocketException.h
daemon.o: daemon.cc ServerExitConditions.h
