prefix = @prefix@
exec_prefix = $(prefix)
bindir = $(exec_prefix)/bin
AR = ar
CXX = @CXX@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

MODULES = @MODULES@
PACKAGES = @PACKAGES@

SRCS:=OPeNDAPServerHandler.cc ServerApp.cc
OBJS:=OPeNDAPServerHandler.o ServerApp.o

PROGS:=opendapserver opendapdaemon
PROG_SRCS:=daemon.cc
PROG_OBJS:=daemon.o

INCS:=-I. @INCS@

DEFS:=@DEFS@

LDFLAGS:=@LDFLAGS@
LIBS:=@LIBS@
MODS:=@MODS@
SLDFLAGS:=$(OBJS) $(MODS) $(MODULES) $(PACKAGES) $(LDFLAGS) $(LIBS)

#CXXFLAGS_DEBUG:=-g3 -O0 -Wall -fno-default-inline -fno-defer-pop
#CXXFLAGS:=$(CXXFLAGS_DEBUG) 
CXXFLAGS:=@CXXFLAGS@ -Wall -Wno-deprecated
CPPFLAGS:=$(CXXFLAGS) $(DEFS) $(INCS)

all : $(PROGS)

opendapserver : $(OBJS)
	$(CXX) -o opendapserver $(SLDFLAGS)

opendapdaemon : daemon.o
	$(CXX) -o opendapdaemon daemon.o $(LDFLAGS)

%.o : %.cc
	$(CXX) -c $(CPPFLAGS) $<

install: install-progs

install-progs: $(PROGS)
	-mkdir -p $(bindir)
	$(INSTALL_PROGRAM) -s $(PROGS) $(bindir)

Makefile: Makefile.in
	if [ -x ./config.status ]; \
	then \
	    ${SHELL} ./config.status; \
	else \
	    ./configure; \
	fi

.PHONY: depend
depend: 
	@depend@ -m Makefile.in -- $(CPPFLAGS) -- $(XDODSSRCS) $(DAEMONSRCS)
	$(MAKE) $(MFLAGS) Makefile

clean :
	-rm -f $(OBJS) $(PROG_OBJS) $(PROGS)

distclean : clean
	-rm -rf ServerConfig.h Makefile config.log config.status config.cache autom4te.cache

# DO NOT DELETE; depend requires this line
