prefix = @prefix@
exec_prefix = $(prefix)
bindir = $(exec_prefix)/bin
AR = ar
CXX = @CXX@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
INSTALL_PROGRAM = @INSTALL_PROGRAM@

MODULES = @MODULES@
PACKAGES = @PACKAGES@
AGGREGATION = @AGGREGATION@

PROGS:=dodsserverd xdods
XDODSSRCS:=ServerMain.cc Server.cc
XDODSOBJS:=ServerMain.o Server.o
LDFLAGS:=@LDFLAGS@
LIBS:=@LIBS@
MODS:=@MODS@
XDODSLDFLAGS:=$(XDODSOBJS) $(MODS) $(AGGREGATION) $(MODULES) $(PACKAGES) $(LDFLAGS) $(LIBS)

DAEMONSRCS:=ServerDaemon.cc
DAEMONOBJS:=ServerDaemon.o
DAEMONLIBS:=

INCS:=-I. @INCS@

DEFS:=@DEFS@

#CXXFLAGS_DEBUG:=-g3 -O0 -Wall -fno-default-inline -fno-defer-pop
#CXXFLAGS:=$(CXXFLAGS_DEBUG) 
CXXFLAGS:=@CXXFLAGS@ -Wall -Wno-deprecated
CPPFLAGS:=$(CXXFLAGS) $(DEFS) $(INCS)

all : $(PROGS)

xdods : $(XDODSOBJS) $(XDODSLIBS)
	$(CXX) -o xdods $(XDODSLDFLAGS)

dodsserverd : $(DAEMONOBJS)
	$(CXX) -o dodsserverd $(DAEMONOBJS) $(DAEMONLIBS)

%.o : %.cc
	$(CXX) -c $(CPPFLAGS) $<

install: install-progs

install-progs: $(PROGS)
	-mkdir -p $(bindir)
	$(INSTALL_PROGRAM) -s $(PROGS) $(bindir)

Makefile: Makefile.in
	if [ -x ./config.status ]; \
	then \
	    ${SHELL} ./config.status; \
	else \
	    ./configure; \
	fi

.PHONY: depend
depend: 
	@depend@ -m Makefile.in -- $(CPPFLAGS) -- $(XDODSSRCS) $(DAEMONSRCS)
	$(MAKE) $(MFLAGS) Makefile

clean :
	-rm -f $(XDODSOBJS) $(DAEMONOBJS) $(PROGS)

distclean : clean
	-rm -f Makefile config.log config.status config.cache

# DO NOT DELETE; depend requires this line
